{"version":3,"file":"index.esm.js","sources":["../src/Live2DCharacter.tsx","../src/AudioAnalyzer.ts","../src/useLive2DAudio.ts"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport * as PIXI from 'pixi.js';\nimport { Live2DCharacterProps } from './types';\n\n// Enable Live2D global mixins for PIXI\nif (typeof window !== 'undefined') {\n  (window as any).PIXI = PIXI;\n}\n\n// Dynamically import Live2D to avoid SSR issues\nlet Live2DModel: any = null;\nif (typeof window !== 'undefined') {\n  import('pixi-live2d-display').then((module) => {\n    Live2DModel = module.Live2DModel;\n  });\n}\n\nconst DefaultLoadingComponent = () => (\n  <div style={{\n    position: 'absolute',\n    inset: 0,\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    backgroundColor: 'rgba(240, 240, 240, 0.75)',\n  }}>\n    <div style={{ textAlign: 'center' }}>\n      <div style={{\n        width: '48px',\n        height: '48px',\n        border: '4px solid #3b82f6',\n        borderTopColor: 'transparent',\n        borderRadius: '50%',\n        animation: 'spin 1s linear infinite',\n        margin: '0 auto 16px',\n      }} />\n      <p style={{ color: '#374151' }}>Loading Live2D model...</p>\n    </div>\n  </div>\n);\n\nconst DefaultErrorComponent = ({ error }: { error: string }) => (\n  <div style={{\n    position: 'absolute',\n    inset: 0,\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    backgroundColor: 'rgba(254, 242, 242, 0.9)',\n  }}>\n    <div style={{ textAlign: 'center', padding: '24px' }}>\n      <p style={{ color: '#dc2626', fontWeight: 600, marginBottom: '8px' }}>エラー</p>\n      <p style={{ color: '#ef4444', fontSize: '14px' }}>{error}</p>\n    </div>\n  </div>\n);\n\n/**\n * Live2D Character Component\n *\n * A React component that displays a Live2D model with lip-sync and blinking animations.\n *\n * @example\n * ```tsx\n * import { Live2DCharacter } from 'react-live2d-lipsync';\n *\n * function App() {\n *   const [audioVolume, setAudioVolume] = useState(0);\n *\n *   return (\n *     <Live2DCharacter\n *       modelPath=\"/models/character.model3.json\"\n *       audioVolume={audioVolume}\n *       positionY={-0.3}\n *       scale={1.2}\n *     />\n *   );\n * }\n * ```\n */\nexport const Live2DCharacter: React.FC<Live2DCharacterProps> = ({\n  modelPath,\n  audioVolume = 0,\n  onModelLoaded,\n  onModelError,\n  positionY = 0,\n  positionX = 0,\n  scale = 1,\n  width = 640,\n  height = 960,\n  backgroundColor = 0xf0f0f0,\n  antialias = true,\n  className = '',\n  style = {},\n  enableBlinking = true,\n  blinkInterval = [2000, 6000],\n  blinkDuration = 100,\n  enableLipSync = true,\n  lipSyncSensitivity = 1.5,\n  showLoading = true,\n  showError = true,\n  loadingComponent,\n  errorComponent,\n}) => {\n  const canvasRef = useRef<HTMLDivElement>(null);\n  const appRef = useRef<PIXI.Application | null>(null);\n  const modelRef = useRef<any>(null);\n  const blinkTimerRef = useRef<NodeJS.Timeout | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    const initLive2D = async () => {\n      if (!canvasRef.current) return;\n\n      // Prevent multiple initializations\n      if (appRef.current) return;\n\n      // Wait for Live2DModel to be loaded\n      if (!Live2DModel) {\n        const checkModel = setInterval(() => {\n          if (Live2DModel) {\n            clearInterval(checkModel);\n            initLive2D();\n          }\n        }, 100);\n        return;\n      }\n\n      // Wait for Live2D SDK to be loaded\n      if (typeof window !== 'undefined' && (!(window as any).Live2DCubismCore && !(window as any).Live2D)) {\n        const checkSDK = setInterval(() => {\n          if ((window as any).Live2DCubismCore || (window as any).Live2D) {\n            clearInterval(checkSDK);\n            initLive2D();\n          }\n        }, 100);\n        return;\n      }\n\n      try {\n        // Clear any existing content\n        canvasRef.current.innerHTML = '';\n\n        // Create PIXI Application\n        const app = new PIXI.Application({\n          width,\n          height,\n          backgroundColor,\n          antialias,\n        });\n\n        appRef.current = app;\n        canvasRef.current.appendChild(app.view as HTMLCanvasElement);\n\n        // Load Live2D model\n        const model = await Live2DModel.from(modelPath);\n        modelRef.current = model;\n\n        // Scale and position model - use width/height directly instead of app.screen\n        const screenWidth = app.screen?.width || width;\n        const screenHeight = app.screen?.height || height;\n\n        const scaleX = (screenWidth * 0.8) / model.width;\n        const scaleY = (screenHeight * 0.8) / model.height;\n        const baseScale = Math.min(scaleX, scaleY);\n\n        model.scale.set(baseScale * scale);\n        model.x = screenWidth / 2 + (positionX * screenWidth / 2);\n        model.y = screenHeight / 2 + (positionY * screenHeight / 2);\n        model.anchor.set(0.5, 0.5);\n\n        app.stage.addChild(model);\n\n        // Initialize parameters\n        if (model.internalModel && model.internalModel.coreModel) {\n          model.internalModel.coreModel.setParameterValueById('ParamMouthOpenY', 0);\n          model.internalModel.coreModel.setParameterValueById('ParamEyeLOpen', 1);\n          model.internalModel.coreModel.setParameterValueById('ParamEyeROpen', 1);\n        }\n\n        // Start blinking animation if enabled\n        if (enableBlinking) {\n          startBlinking();\n        }\n\n        setIsLoading(false);\n        onModelLoaded?.();\n      } catch (err) {\n        const errorMessage = err instanceof Error ? err.message : String(err);\n        console.error('Failed to load Live2D model:', err);\n        setError(`モデル読み込みエラー: ${errorMessage}`);\n        setIsLoading(false);\n        onModelError?.(err instanceof Error ? err : new Error(errorMessage));\n      }\n    };\n\n    initLive2D();\n\n    return () => {\n      if (blinkTimerRef.current) {\n        clearTimeout(blinkTimerRef.current);\n        blinkTimerRef.current = null;\n      }\n      if (modelRef.current) {\n        modelRef.current.destroy();\n        modelRef.current = null;\n      }\n      if (appRef.current) {\n        appRef.current.destroy(true, { children: true, texture: true, baseTexture: true });\n        appRef.current = null;\n      }\n      if (canvasRef.current) {\n        canvasRef.current.innerHTML = '';\n      }\n    };\n  }, [modelPath, width, height, backgroundColor, antialias, enableBlinking]);\n\n  // Blinking animation\n  const startBlinking = () => {\n    const blink = () => {\n      if (!modelRef.current?.internalModel?.coreModel) return;\n\n      const coreModel = modelRef.current.internalModel.coreModel;\n\n      // Close eyes\n      coreModel.setParameterValueById('ParamEyeLOpen', 0);\n      coreModel.setParameterValueById('ParamEyeROpen', 0);\n\n      // Open eyes after specified duration\n      setTimeout(() => {\n        if (coreModel) {\n          coreModel.setParameterValueById('ParamEyeLOpen', 1);\n          coreModel.setParameterValueById('ParamEyeROpen', 1);\n        }\n      }, blinkDuration);\n\n      // Schedule next blink with random interval\n      const [minInterval, maxInterval] = blinkInterval;\n      const nextInterval = minInterval + Math.random() * (maxInterval - minInterval);\n      blinkTimerRef.current = setTimeout(blink, nextInterval);\n    };\n\n    blink();\n  };\n\n  // Update mouth based on audio volume (lip-sync)\n  useEffect(() => {\n    if (!modelRef.current?.internalModel?.coreModel || !enableLipSync) return;\n\n    const smoothVolume = Math.min(audioVolume * lipSyncSensitivity, 1);\n    modelRef.current.internalModel.coreModel.setParameterValueById(\n      'ParamMouthOpenY',\n      smoothVolume\n    );\n  }, [audioVolume, enableLipSync, lipSyncSensitivity]);\n\n  // Update model position and scale when props change\n  useEffect(() => {\n    if (!modelRef.current || !appRef.current) return;\n\n    const app = appRef.current;\n    const model = modelRef.current;\n\n    // Recalculate scale\n    const scaleX = (app.screen.width * 0.8) / model.width;\n    const scaleY = (app.screen.height * 0.8) / model.height;\n    const baseScale = Math.min(scaleX, scaleY);\n\n    model.scale.set(baseScale * scale);\n    model.x = app.screen.width / 2 + (positionX * app.screen.width / 2);\n    model.y = app.screen.height / 2 + (positionY * app.screen.height / 2);\n  }, [positionY, positionX, scale]);\n\n  return (\n    <div className={className} style={{ position: 'relative', ...style }}>\n      <div ref={canvasRef} />\n\n      {isLoading && showLoading && (\n        loadingComponent || <DefaultLoadingComponent />\n      )}\n\n      {error && showError && (\n        errorComponent || <DefaultErrorComponent error={error} />\n      )}\n    </div>\n  );\n};\n","import { AudioAnalyzerOptions } from './types';\n\nexport class AudioAnalyzer {\n  private audioContext: AudioContext | null = null;\n  private analyser: AnalyserNode | null = null;\n  private dataArray: Uint8Array<ArrayBuffer> | null = null;\n  private source: MediaElementAudioSourceNode | null = null;\n  private options: Required<AudioAnalyzerOptions>;\n\n  constructor(options: AudioAnalyzerOptions = {}) {\n    this.options = {\n      fftSize: options.fftSize ?? 256,\n      smoothingTimeConstant: options.smoothingTimeConstant ?? 0.8,\n    };\n  }\n\n  initialize(audioElement: HTMLAudioElement): void {\n    if (this.audioContext) {\n      return; // Already initialized\n    }\n\n    this.audioContext = new AudioContext();\n    this.analyser = this.audioContext.createAnalyser();\n    this.analyser.fftSize = this.options.fftSize;\n    this.analyser.smoothingTimeConstant = this.options.smoothingTimeConstant;\n\n    const bufferLength = this.analyser.frequencyBinCount;\n    this.dataArray = new Uint8Array(bufferLength);\n\n    this.source = this.audioContext.createMediaElementSource(audioElement);\n    this.source.connect(this.analyser);\n    this.analyser.connect(this.audioContext.destination);\n  }\n\n  getVolume(): number {\n    if (!this.analyser || !this.dataArray) return 0;\n\n    this.analyser.getByteFrequencyData(this.dataArray);\n\n    // Calculate average volume with emphasis on lower frequencies (speech range)\n    let sum = 0;\n    const speechRange = Math.floor(this.dataArray.length * 0.3); // Focus on lower 30%\n\n    for (let i = 0; i < speechRange; i++) {\n      sum += this.dataArray[i];\n    }\n    const average = sum / speechRange;\n\n    // Normalize to 0-1 range\n    return average / 255;\n  }\n\n  cleanup(): void {\n    if (this.source) {\n      this.source.disconnect();\n      this.source = null;\n    }\n    if (this.analyser) {\n      this.analyser.disconnect();\n      this.analyser = null;\n    }\n    if (this.audioContext) {\n      this.audioContext.close();\n      this.audioContext = null;\n    }\n    this.dataArray = null;\n  }\n\n  isInitialized(): boolean {\n    return this.audioContext !== null;\n  }\n}\n","import { useEffect, useRef, useState } from 'react';\nimport { AudioAnalyzer } from './AudioAnalyzer';\nimport { UseLive2DAudioOptions } from './types';\n\n/**\n * Custom hook for managing Live2D audio analysis\n */\nexport function useLive2DAudio(options: UseLive2DAudioOptions = {}) {\n  const {\n    audioElement,\n    enabled = true,\n    analyzerOptions,\n    onPlay,\n    onPause,\n    onEnded,\n  } = options;\n\n  const [audioVolume, setAudioVolume] = useState(0);\n  const analyzerRef = useRef<AudioAnalyzer | null>(null);\n  const animationFrameRef = useRef<number | null>(null);\n\n  useEffect(() => {\n    if (!audioElement || !enabled) return;\n\n    const handlePlay = () => {\n      if (!analyzerRef.current) {\n        analyzerRef.current = new AudioAnalyzer(analyzerOptions);\n        analyzerRef.current.initialize(audioElement);\n      }\n\n      const updateVolume = () => {\n        if (analyzerRef.current && !audioElement.paused) {\n          const volume = analyzerRef.current.getVolume();\n          setAudioVolume(volume);\n          animationFrameRef.current = requestAnimationFrame(updateVolume);\n        }\n      };\n\n      updateVolume();\n      onPlay?.();\n    };\n\n    const handlePause = () => {\n      setAudioVolume(0);\n      if (animationFrameRef.current) {\n        cancelAnimationFrame(animationFrameRef.current);\n        animationFrameRef.current = null;\n      }\n      onPause?.();\n    };\n\n    const handleEnded = () => {\n      setAudioVolume(0);\n      if (animationFrameRef.current) {\n        cancelAnimationFrame(animationFrameRef.current);\n        animationFrameRef.current = null;\n      }\n      onEnded?.();\n    };\n\n    audioElement.addEventListener('play', handlePlay);\n    audioElement.addEventListener('pause', handlePause);\n    audioElement.addEventListener('ended', handleEnded);\n\n    return () => {\n      audioElement.removeEventListener('play', handlePlay);\n      audioElement.removeEventListener('pause', handlePause);\n      audioElement.removeEventListener('ended', handleEnded);\n\n      if (animationFrameRef.current) {\n        cancelAnimationFrame(animationFrameRef.current);\n      }\n      if (analyzerRef.current) {\n        analyzerRef.current.cleanup();\n        analyzerRef.current = null;\n      }\n    };\n  }, [audioElement, enabled, analyzerOptions, onPlay, onPause, onEnded]);\n\n  return { audioVolume };\n}\n"],"names":[],"mappings":"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"}